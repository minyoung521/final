<!DOCTYPE HTML>
<html>
{% load static %}
<head>
   <meta charset="utf-8">
   <meta http-equiv="X-UA-Compatible" content="IE=edge">
   <title>자유게시판</title>
   <meta name="viewport" content="width=device-width, initial-scale=1">
   <meta name="description" content="Free HTML5 Website Template by freehtml5.co" />
   <meta name="keywords" content="free website templates, free html5, free template, free bootstrap, free website template, html5, css3, mobile first, responsive" />
   <meta name="author" content="freehtml5.co" />

   <!-- Facebook and Twitter integration -->
   <meta property="og:title" content=""/>
   <meta property="og:image" content=""/>
   <meta property="og:url" content=""/>
   <meta property="og:site_name" content=""/>
   <meta property="og:description" content=""/>
   <meta name="twitter:title" content="" />
   <meta name="twitter:image" content="" />
   <meta name="twitter:url" content="" />
   <meta name="twitter:card" content="" />

   <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600,700" rel="stylesheet">
   <link href="https://fonts.googleapis.com/css?family=Roboto+Slab:300,400" rel="stylesheet">
   <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
   <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">

   <!-- Animate.css -->
   <link rel="stylesheet" href="{% static 'css/animate.css' %}">
   <!-- Icomoon Icon Fonts-->
   <link rel="stylesheet" href="{% static 'css/icomoon.css' %}">
   <!-- Bootstrap  -->
   <link rel="stylesheet" href="{% static 'css/bootstrap.css' %}">
   <link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}">

   <!-- Magnific Popup -->
   <link rel="stylesheet" href="{% static 'css/magnific-popup.css' %}">

   <!-- Owl Carousel  -->
   <link rel="stylesheet" href="{% static 'css/owl.carousel.min.css' %}">
   <link rel="stylesheet" href="{% static 'css/owl.theme.default.min.css' %}">

   <!-- Flexslider  -->
   <link rel="stylesheet" href="{% static 'css/flexslider.css' %}">

   <!-- Pricing -->
   <link rel="stylesheet" href="{% static 'css/pricing.css' %}">

   <!-- Theme style  -->
   <link rel="stylesheet" href="{% static 'css/style.css' %}">

   <!-- Modernizr JS -->
   <script src="{% static 'js/modernizr-2.6.2.min.js' %}"></script>
   <!-- FOR IE9 below -->
   <!--[if lt IE 9]>
   <script src="{% static 'js/respond.min.js' %}"></script>
   <![endif]-->

</head>
<body>

<div class="fh5co-loader"></div>

<div id="page">
<nav class="fh5co-nav" role="navigation">
   <div class="top">
      <div class="container">
         <div class="row">
            <div class="col-xs-12 text-right">
               <p class="site"></p>
               <p class="num">Call: +01 123 456 7890</p>
               <ul class="fh5co-social">
                  <li><a href="#"><i class="icon-facebook2"></i></a></li>
                  <li><a href="#"><i class="icon-twitter2"></i></a></li>
                  <li><a href="#"><i class="icon-dribbble2"></i></a></li>
                  <li><a href="#"><i class="icon-github"></i></a></li>
               </ul>
            </div>
         </div>
      </div>
   </div>

   <div class="top-menu">
      <div class="container">
         <div class="row">
            <div class="col-xs-2">
               <div id="fh5co-logo"><a href="{% url 'web:home' %}"><i class="icon-study"></i>돔고돔락<span></span></a></div>
            </div>
            <div class="col-xs-10 text-right menu-1">
               <ul>
                  <li><a href="{% url 'web:home' %}">홈페이지</a></li>
                  <li class="has-dropdown">
                     <a href="{% url 'web:guide' %}">생활관 안내</a>
                     <ul class="dropdown">
                        {% if user.is_authenticated %}
                        <li><a href="{% url 'web:check_in' %}">입실 신청</a></li>
                        <li><a href="{% url 'web:outside' %}">외박 신청</a></li>
                        <li><a href="{% url 'web:info' %}">생활관 안내</a></li>
                        <li><a href="{% url 'web:rules' %}">생활관 규칙</a></li>
                        {% else %}
                        <li><a href="" onclick="alert('로그인이 필요한 페이지입니다.'); window.location.href='{% url 'web:login' %}'; return false;">입실 신청</a></li>
                        <li><a href="" onclick="alert('로그인이 필요한 페이지입니다.'); window.location.href='{% url 'web:login' %}'; return false;">외박 신청</a></li>
                        <li><a href="{% url 'web:info' %}">생활관 안내</a></li>
                        <li><a href="{% url 'web:rules' %}">생활관 규칙</a></li>
                        {% endif %}
                     </ul>
                  </li>
                  <li class="has-dropdown">
                     <a href="{% url 'web:community' %}">커뮤니티</a>
                     <ul class="dropdown">
                        {% if user.is_authenticated %}
                        <li><a href="{% url 'web:notice' %}">공지 사항</a></li>
                        <li><a href="{% url 'web:community_home' %}">자유 게시판</a></li>
                        {% else %}
                        <li><a href="" onclick="alert('로그인이 필요한 페이지입니다.'); window.location.href='{% url 'web:login' %}'; return false;">공지 사항</a></li>
                        <li><a href="" onclick="alert('로그인이 필요한 페이지입니다.'); window.location.href='{% url 'web:login' %}'; return false;">자유 게시판</a></li>
                        {% endif %}
                     </ul>
                  </li>
                  <li class="has-dropdown">
                     {% if user.is_authenticated %}
                        <a href="{% url 'web:mypage' %}">마이페이지</a>
                     {% else %}
                        <a href="" onclick="alert('로그인이 필요한 페이지입니다.'); window.location.href='{% url 'web:login' %}'; return false;">마이페이지</a>
                     {% endif %}
                  </li>
                  {% if user.is_authenticated %}
                 <li class="btn-cta" style="margin-right: 10px;">
                    <span class="btn-cta">{{ user.userprofile.full_name|default:user.username }}님, 환영합니다!</span>
                 </li>
                 <li class="btn-cta">
                    <form method="post" action="{% url 'web:logout' %}" style="display: inline;">
                       {% csrf_token %}
                       <button type="submit" class="btn btn-link p-0" style="text-decoration: none; color: blue;">
                          로그아웃
                       </button>
                    </form>
                 </li>
                 {% else %}
                 <li class="btn-cta">
                    <a href="{% url 'web:login' %}"><span>로그인</span></a>
                 </li>
                 {% endif %}
               </ul>
            </div>
         </div>
      </div>
   </div>
</nav>

<div class="container mt-5">
   <h2 class="text-center mb-4">자유게시판</h2>

    <!-- 검색창 -->
        <form method="get" class="text-center mb-4">
            <div class="input-group w-50 mx-auto">
                <input type="text" name="kw" value="{{ request.GET.kw }}" class="form-control" placeholder="검색어를 입력해 주세요.">
                <span class="input-group-btn">
                    <button type="submit" class="btn btn-cta"><span>검색</span></button>
                </span>
            </div>
        </form>

   <table class="table table-bordered text-center">
     <thead class="table-light">
       <tr>
         <th class="text-center" style="width: 8%;">번호</th>
         <th class="text-center" style="width: 40%;">제목</th>
         <th class="text-center" style="width: 10%;">작성자</th>
         <th class="text-center" style="width: 15%;">작성일</th>
         <th class="text-center" style="width: 10%;">좋아요 수</th>
         <th class="text-center" style="width: 10%;">댓글 수</th>
         {% if user.is_authenticated %}
         <th class="text-center" style="width: 7%;">관리</th>
         {% endif %}
       </tr>
     </thead>
     <tbody>
       {% if posts %}
         {% for post in posts %}
           <tr>
             <td>{{ forloop.counter }}</td>
             <td><a href="{% url 'web:community_detail' post.id %}">{{ post.title }}</a></td>
             <td><i class="fas fa-user-circle"></i> 익명{{ forloop.revcounter }}</td>
             <td>{{ post.created_at|date:"Y-m-d H:i" }}</td>
             <td><span class="badge bg-warning text-dark"><i class="fas fa-heart"></i> {{ post.likes.count }}</span></td>
             <td><span class="badge bg-info text-dark"><i class="fas fa-comments"></i> {{ post.comments.count }}</span></td>
             {% if user.is_authenticated %}
             <td>
               {% if user == post.author or user.is_staff %}
               <form method="POST" action="{% url 'web:community_delete' post.id %}" onsubmit="return confirm('정말 삭제하시겠습니까?');">
                 {% csrf_token %}
                 <button type="submit" class="btn btn-sm btn-danger">삭제</button>
               </form>
               {% else %}
               <span class="text-muted">-</span>
               {% endif %}
             </td>
             {% endif %}
           </tr>
         {% endfor %}
       {% else %}
         <tr>
           <td colspan="{% if user.is_authenticated %}7{% else %}6{% endif %}">등록된 게시글이 없습니다.</td>
         </tr>
       {% endif %}
     </tbody>
   </table>

   <!-- 글쓰기 버튼 -->
   <div class="text-end mt-3">
       {% if user.is_authenticated %}
        <a href="{% url 'web:community_create'%}" class="btn btn-primary ms-2">글쓰기</a>
      {% else %}
        <a href="{% url 'web:login' %}" class="btn btn-primary ms-2">글쓰기</a>
      {% endif %}
   </div>
</div>

<script src="{% static 'js/jquery.min.js' %}"></script>
<script src="{% static 'js/jquery.easing.1.3.js' %}"></script>
<script src="{% static 'js/bootstrap.min.js' %}"></script>
<script src="{% static 'js/jquery.waypoints.min.js' %}"></script>
<script src="{% static 'js/jquery.stellar.min.js' %}"></script>
<script src="{% static 'js/owl.carousel.min.js' %}"></script>
<script src="{% static 'js/jquery.flexslider-min.js' %}"></script>
<script src="{% static 'js/jquery.countTo.js' %}"></script>
<script src="{% static 'js/jquery.magnific-popup.min.js' %}"></script>
<script src="{% static 'js/magnific-popup-options.js' %}"></script>
<script src="{% static 'js/simplyCountdown.js' %}"></script>
<script src="{% static 'js/main.js' %}"></script>

<script>
   var d = new Date(new Date().getTime() + 1000 * 120 * 120 * 2000);
   simplyCountdown('.simply-countdown-one', {
      year: d.getFullYear(),
      month: d.getMonth() + 1,
      day: d.getDate()
   });
   $('#simply-countdown-losange').simplyCountdown({
      year: d.getFullYear(),
      month: d.getMonth() + 1,
      day: d.getDate(),
      enableUtc: false
   });
</script>

</div>
</body>
</html>